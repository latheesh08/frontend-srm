{"ast":null,"code":"var _jsxFileName = \"/Users/star/Desktop/frontend-srm/src/app/home/studentHome/Announcements.js\";\nimport React, { useState, useEffect } from \"react\";\nimport { connect } from \"react-redux\";\nimport { useLocation } from \"react-router-dom\";\nimport { makeStyles } from \"@material-ui/styles\";\nimport InfiniteScroll from \"react-infinite-scroll-component\";\nimport { Typography } from \"@material-ui/core\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport AnnouncementCard from \"./AnnouncementCard\";\nimport HomeService from \"../HomeSerivce\";\nimport { set } from \"date-fns\";\nconst useStyles = makeStyles(theme => ({\n  loading: {\n    width: \"100%\",\n    textAlign: \"center\",\n    paddingTop: \"8px\",\n    fontSize: \"20px\"\n  }\n}));\n\nconst Announcements = props => {\n  const location = useLocation();\n  const classes = useStyles();\n  const [announcements, setAnnouncements] = useState([{\n    id: 1,\n    title: \"Tempora.\",\n    summary: \"Voluptatem dicta minus quisquam quo qui. Nemo libero maiores nihil doloribus aut commodi. Possimus repellat et odio aut recusandae. Itaque non odio vero culpa aliquid ea. Aut non est veritatis.\",\n    main_content: '<html><head><title>Ut eos.</title></head><body><form action=\"example.com\" method=\"POST\"><label for=\"username\">impedit</label><input type=\"text\" id=\"username\"><label for=\"password\">commodi</label><input type=\"password\" id=\"password\"></form><div class=\"quod\"></div></body></html>\\n',\n    category_id: 20,\n    published_to: \"[76, 16, 19, 81, 2, 87]\",\n    published_date: \"2020-08-22\",\n    event_date: \"2020-08-30\",\n    sorting_date: \"2020-08-22\",\n    reminder_date: \"2020-08-25\",\n    media_url: \"https://lorempixel.com/640/480/?45842\",\n    created_by: 5,\n    updated_by: 5,\n    created_at: null,\n    updated_at: null,\n    deleted_at: null\n  }]);\n  const [hasMore, setHasMore] = useState(true);\n  const [currentPage, setCurrentPage] = useState(1); // const [isAnnouncementLoading, setIsAnnouncementLoading] = useState(true);\n\n  useEffect(() => {\n    // if (isAnnouncementLoading) {\n    let isAnnouncementLoading = true;\n\n    const fetchData = async () => {\n      try {\n        const token = localStorage.getItem(\"srmToken\");\n        const selectedRole = props.selectedRole;\n        const response = await HomeService.fetchAnnouncements({\n          selectedRole,\n          currentPage\n        }, token);\n\n        if (response.status === 200) {\n          if (response.data.data.current_page === response.data.data.last_page) {\n            if (isAnnouncementLoading) {\n              setAnnouncements([...announcements, ...response.data.data.data]);\n              setHasMore(false);\n            }\n          } else {\n            if (isAnnouncementLoading) {\n              setAnnouncements([...announcements, ...response.data.data.data]);\n              setCurrentPage(currentPage + 1);\n            }\n          }\n        }\n      } catch (e) {\n        console.log(e);\n      }\n    };\n\n    fetchData();\n    return () => {\n      isAnnouncementLoading = false;\n    };\n  }, []);\n\n  const fetchAnnouncementOnScroll = async () => {\n    try {\n      const token = localStorage.getItem(\"srmToken\");\n      const selectedRole = props.selectedRole;\n      const response = await HomeService.fetchAnnouncements({\n        selectedRole,\n        currentPage\n      }, token);\n\n      if (response.status === 200) {\n        if (response.data.data.current_page !== response.data.data.last_page) {\n          setAnnouncements([...announcements, ...response.data.data.data]);\n          setCurrentPage(currentPage + 1);\n        } else {\n          setAnnouncements([...announcements, ...response.data.data.data]);\n          setHasMore(false);\n        }\n      }\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  let content = announcements.map((announcement, index) => {\n    return /*#__PURE__*/React.createElement(AnnouncementCard, {\n      key: index,\n      announcement: announcement,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 12\n      }\n    });\n  });\n  return /*#__PURE__*/React.createElement(InfiniteScroll, {\n    dataLength: announcements.length,\n    next: fetchAnnouncementOnScroll,\n    hasMore: hasMore,\n    loader: /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n      className: classes.loading,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(CircularProgress, {\n      color: \"primary\",\n      size: 30,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 13\n      }\n    })), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 11\n      }\n    })),\n    scrollableTarget: \"scrollable\",\n    scrollThreshold: 0.2,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 5\n    }\n  }, content);\n};\n\nconst mapStateToProps = state => {\n  return {\n    selectedRole: state.selectedRole\n  };\n};\n\nexport default connect(mapStateToProps)(Announcements);","map":{"version":3,"sources":["/Users/star/Desktop/frontend-srm/src/app/home/studentHome/Announcements.js"],"names":["React","useState","useEffect","connect","useLocation","makeStyles","InfiniteScroll","Typography","CircularProgress","AnnouncementCard","HomeService","set","useStyles","theme","loading","width","textAlign","paddingTop","fontSize","Announcements","props","location","classes","announcements","setAnnouncements","id","title","summary","main_content","category_id","published_to","published_date","event_date","sorting_date","reminder_date","media_url","created_by","updated_by","created_at","updated_at","deleted_at","hasMore","setHasMore","currentPage","setCurrentPage","isAnnouncementLoading","fetchData","token","localStorage","getItem","selectedRole","response","fetchAnnouncements","status","data","current_page","last_page","e","console","log","fetchAnnouncementOnScroll","error","content","map","announcement","index","length","mapStateToProps","state"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { connect } from \"react-redux\";\nimport { useLocation } from \"react-router-dom\";\nimport { makeStyles } from \"@material-ui/styles\";\nimport InfiniteScroll from \"react-infinite-scroll-component\";\nimport { Typography } from \"@material-ui/core\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport AnnouncementCard from \"./AnnouncementCard\";\nimport HomeService from \"../HomeSerivce\";\nimport { set } from \"date-fns\";\nconst useStyles = makeStyles((theme) => ({\n  loading: {\n    width: \"100%\",\n    textAlign: \"center\",\n    paddingTop: \"8px\",\n    fontSize: \"20px\",\n  },\n}));\n\nconst Announcements = (props) => {\n  const location = useLocation();\n  const classes = useStyles();\n  const [announcements, setAnnouncements] = useState([\n    {\n      id: 1,\n      title: \"Tempora.\",\n      summary:\n        \"Voluptatem dicta minus quisquam quo qui. Nemo libero maiores nihil doloribus aut commodi. Possimus repellat et odio aut recusandae. Itaque non odio vero culpa aliquid ea. Aut non est veritatis.\",\n      main_content:\n        '<html><head><title>Ut eos.</title></head><body><form action=\"example.com\" method=\"POST\"><label for=\"username\">impedit</label><input type=\"text\" id=\"username\"><label for=\"password\">commodi</label><input type=\"password\" id=\"password\"></form><div class=\"quod\"></div></body></html>\\n',\n      category_id: 20,\n      published_to: \"[76, 16, 19, 81, 2, 87]\",\n      published_date: \"2020-08-22\",\n      event_date: \"2020-08-30\",\n      sorting_date: \"2020-08-22\",\n      reminder_date: \"2020-08-25\",\n      media_url: \"https://lorempixel.com/640/480/?45842\",\n      created_by: 5,\n      updated_by: 5,\n      created_at: null,\n      updated_at: null,\n      deleted_at: null,\n    },\n  ]);\n  const [hasMore, setHasMore] = useState(true);\n  const [currentPage, setCurrentPage] = useState(1);\n\n  // const [isAnnouncementLoading, setIsAnnouncementLoading] = useState(true);\n  useEffect(() => {\n    // if (isAnnouncementLoading) {\n    let isAnnouncementLoading = true;\n    const fetchData = async () => {\n      try {\n        const token = localStorage.getItem(\"srmToken\");\n        const selectedRole = props.selectedRole;\n        const response = await HomeService.fetchAnnouncements(\n          { selectedRole, currentPage },\n          token\n        );\n\n        if (response.status === 200) {\n          if (\n            response.data.data.current_page === response.data.data.last_page\n          ) {\n            if (isAnnouncementLoading) {\n              setAnnouncements([...announcements, ...response.data.data.data]);\n              setHasMore(false);\n            }\n          } else {\n            if (isAnnouncementLoading) {\n              setAnnouncements([...announcements, ...response.data.data.data]);\n              setCurrentPage(currentPage + 1);\n            }\n          }\n        }\n      } catch (e) {\n        console.log(e);\n      }\n    };\n    fetchData();\n\n    return () => {\n      isAnnouncementLoading = false;\n    };\n  }, []);\n\n  const fetchAnnouncementOnScroll = async () => {\n    try {\n      const token = localStorage.getItem(\"srmToken\");\n      const selectedRole = props.selectedRole;\n      const response = await HomeService.fetchAnnouncements(\n        { selectedRole, currentPage },\n        token\n      );\n\n      if (response.status === 200) {\n        if (response.data.data.current_page !== response.data.data.last_page) {\n          setAnnouncements([...announcements, ...response.data.data.data]);\n          setCurrentPage(currentPage + 1);\n        } else {\n          setAnnouncements([...announcements, ...response.data.data.data]);\n\n          setHasMore(false);\n        }\n      }\n    } catch (error) {\n      console.log(error);\n    }\n  };\n  let content = announcements.map((announcement, index) => {\n    return <AnnouncementCard key={index} announcement={announcement} />;\n  });\n  return (\n    <InfiniteScroll\n      dataLength={announcements.length}\n      next={fetchAnnouncementOnScroll}\n      hasMore={hasMore}\n      loader={\n        <>\n          <div className={classes.loading}>\n            {/* <Typography>Loading...</Typography> */}\n            <CircularProgress color=\"primary\" size={30} />\n          </div>\n          <br />\n        </>\n      }\n      scrollableTarget=\"scrollable\"\n      scrollThreshold={0.2}\n    >\n      {content}\n    </InfiniteScroll>\n  );\n};\n\nconst mapStateToProps = (state) => {\n  return {\n    selectedRole: state.selectedRole,\n  };\n};\n\nexport default connect(mapStateToProps)(Announcements);\n"]},"metadata":{},"sourceType":"module"}