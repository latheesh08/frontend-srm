{"ast":null,"code":"var _jsxFileName = \"/Users/star/Desktop/frontend-srm/src/app/Assignment/HomeworkSection.js\";\nimport 'date-fns';\nimport React, { useState, useRef, useEffect } from 'react';\nimport { connect } from 'react-redux';\nimport { useHistory } from 'react-router-dom';\nimport { makeStyles } from '@material-ui/styles';\nimport DateFnsUtils from '@date-io/date-fns';\nimport { MuiPickersUtilsProvider, KeyboardDatePicker } from '@material-ui/pickers';\nimport Box from '@material-ui/core/Box';\nimport { Typography } from '@material-ui/core';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport InfiniteScroll from 'react-infinite-scroll-component';\nimport HomeworkService from './HomeworkService';\nimport AddIcon from \"../../assets/images/Add.svg\";\nimport HomeworkCard from './teacher/HomeworkCard';\nconst useStyles = makeStyles(theme => ({\n  datePicker: {\n    width: '25%',\n    paddingRight: '10px'\n  },\n  sectionContainer: {\n    height: '100%',\n    width: '100%'\n  },\n  header: {\n    paddingRight: '15px',\n    paddingLeft: '15px',\n    paddingTop: '10px',\n    display: 'inline block'\n  },\n  cardBoxPadding: {\n    padding: '24px',\n    [theme.breakpoints.down('sm')]: {\n      padding: '16px'\n    }\n  },\n  addNew: {\n    color: theme.palette.common.deluge,\n    float: 'right',\n    marginTop: '15px',\n    marginRight: '15px',\n    cursor: 'pointer',\n    '& .new': {\n      float: 'right',\n      fontSize: '14px',\n      padding: '5px'\n    },\n    '& img': {\n      margin: '5px',\n      height: '20px',\n      cursor: 'pointer'\n    }\n  },\n  InfiniteScroll: {\n    overflow: 'revert !important',\n    '& .infinite-scroll-component': {\n      overflow: 'revert !important'\n    }\n  },\n  loading: {\n    width: '100%',\n    textAlign: 'center',\n    paddingTop: '8px',\n    fontSize: '20px'\n  }\n}));\n\nconst HomeworkSection = props => {\n  const classes = useStyles();\n  const history = useHistory();\n  const [selectedFromDate, setFromDate] = useState(null);\n  const [selectedToDate, setToDate] = useState(null);\n  const selectedRole = props.selectedRole;\n  const [hasMore, setHasMore] = useState(true);\n  const [currentPage, setCurrentPage] = useState(1);\n  const [homeworks, setHomeworks] = useState([]);\n  useEffect(() => {\n    let isHomeworkLoading = true;\n\n    const fetchData = async () => {\n      try {\n        const token = localStorage.getItem('srmToken');\n        const selectedRole = props.selectedRole;\n        const response = await HomeworkService.fetchHomework({\n          selectedRole,\n          currentPage\n        }, token);\n\n        if (response.status === 200) {\n          if (response.data.data.current_page === response.data.data.last_page) {\n            if (isHomeworkLoading) {\n              setHomeworks([...homeworks, ...response.data.data.data]);\n              setHasMore(false);\n            }\n          } else {\n            if (isHomeworkLoading) {\n              setHomeworks([...homeworks, ...response.data.data.data]);\n              setCurrentPage(currentPage + 1);\n            }\n          }\n        }\n      } catch (e) {\n        console.log(e);\n      }\n    };\n\n    fetchData();\n    return () => {\n      isHomeworkLoading = false;\n    };\n  }, []);\n\n  const fetchHomeworkOnScroll = async () => {\n    try {\n      const token = localStorage.getItem('srmToken');\n      const selectedRole = props.selectedRole;\n      const response = await HomeworkService.fetchHomework({\n        selectedRole,\n        currentPage\n      }, token);\n\n      if (response.status === 200) {\n        // console.log(response);\n        if (response.data.data.current_page !== response.data.data.last_page) {\n          setHomeworks([...homeworks, ...response.data.data.data]);\n          setCurrentPage(currentPage + 1);\n        } else {\n          setHomeworks([...homeworks, ...response.data.data.data]);\n          setHasMore(false);\n        }\n      }\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  const handleFromDateChange = date => {\n    setFromDate(date);\n  };\n\n  const handleToDateChange = date => {\n    setToDate(date);\n  };\n\n  const handleCreateHomework = async () => {\n    try {\n      const token = localStorage.getItem('srmToken');\n      const response = await HomeworkService.createHomework(token); // console.log(response);\n\n      history.push(`/create-homework/${response.data.homework_id}`);\n    } catch (e) {\n      console.log(e);\n    }\n  };\n\n  let content = homeworks.map((homework, index) => {\n    return /*#__PURE__*/React.createElement(HomeworkCard, {\n      key: homework.id,\n      homework: homework,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 12\n      }\n    });\n  });\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.sectionContainer,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.header,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.filterForm,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 9\n    }\n  }, selectedRole === 'teacher' || selectedRole === 'admin' ? /*#__PURE__*/React.createElement(\"div\", {\n    className: classes.addNew,\n    onClick: handleCreateHomework,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    src: AddIcon,\n    alt: \"add\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 15\n    }\n  }), /*#__PURE__*/React.createElement(Typography, {\n    className: \"new\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 15\n    }\n  }, \"New\")) : '')), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(Box, {\n    className: classes.cardBoxPadding,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(InfiniteScroll, {\n    className: classes.InfiniteScroll,\n    dataLength: homeworks.length,\n    next: fetchHomeworkOnScroll,\n    hasMore: hasMore,\n    loader: /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n      className: classes.loading,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(CircularProgress, {\n      color: \"primary\",\n      size: 30,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 17\n      }\n    })), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193,\n        columnNumber: 15\n      }\n    })),\n    scrollableTarget: \"scrollable\",\n    scrollThreshold: 0.2,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 9\n    }\n  }, content), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 9\n    }\n  })));\n};\n\nconst mapStateToProps = state => {\n  return {\n    selectedRole: state.auth.selectedRole\n  };\n};\n\nexport default connect(mapStateToProps)(HomeworkSection);","map":{"version":3,"sources":["/Users/star/Desktop/frontend-srm/src/app/Assignment/HomeworkSection.js"],"names":["React","useState","useRef","useEffect","connect","useHistory","makeStyles","DateFnsUtils","MuiPickersUtilsProvider","KeyboardDatePicker","Box","Typography","CircularProgress","InfiniteScroll","HomeworkService","HomeworkCard","useStyles","theme","datePicker","width","paddingRight","sectionContainer","height","header","paddingLeft","paddingTop","display","cardBoxPadding","padding","breakpoints","down","addNew","color","palette","common","deluge","float","marginTop","marginRight","cursor","fontSize","margin","overflow","loading","textAlign","HomeworkSection","props","classes","history","selectedFromDate","setFromDate","selectedToDate","setToDate","selectedRole","hasMore","setHasMore","currentPage","setCurrentPage","homeworks","setHomeworks","isHomeworkLoading","fetchData","token","localStorage","getItem","response","fetchHomework","status","data","current_page","last_page","e","console","log","fetchHomeworkOnScroll","error","handleFromDateChange","date","handleToDateChange","handleCreateHomework","createHomework","push","homework_id","content","map","homework","index","id","filterForm","AddIcon","length","mapStateToProps","state","auth"],"mappings":"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","sourcesContent":["import 'date-fns';\nimport React, { useState, useRef, useEffect } from 'react';\nimport { connect } from 'react-redux';\nimport { useHistory } from 'react-router-dom';\nimport { makeStyles } from '@material-ui/styles';\nimport DateFnsUtils from '@date-io/date-fns';\nimport {\n  MuiPickersUtilsProvider,\n  KeyboardDatePicker,\n} from '@material-ui/pickers';\nimport Box from '@material-ui/core/Box';\nimport { Typography } from '@material-ui/core';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport InfiniteScroll from 'react-infinite-scroll-component';\n\nimport HomeworkService from './HomeworkService';\nimport AddIcon from '../../assets/images/Add.svg';\nimport HomeworkCard from './teacher/HomeworkCard';\n\nconst useStyles = makeStyles((theme) => ({\n  datePicker: {\n    width: '25%',\n    paddingRight: '10px',\n  },\n  sectionContainer: {\n    height: '100%',\n    width: '100%',\n  },\n\n  header: {\n    paddingRight: '15px',\n    paddingLeft: '15px',\n    paddingTop: '10px',\n    display: 'inline block',\n  },\n  cardBoxPadding: {\n    padding: '24px',\n    [theme.breakpoints.down('sm')]: {\n      padding: '16px',\n    },\n  },\n  addNew: {\n    color: theme.palette.common.deluge,\n    float: 'right',\n    marginTop: '15px',\n    marginRight: '15px',\n    cursor: 'pointer',\n    '& .new': {\n      float: 'right',\n      fontSize: '14px',\n      padding: '5px',\n    },\n    '& img': {\n      margin: '5px',\n      height: '20px',\n      cursor: 'pointer',\n    },\n  },\n  InfiniteScroll: {\n    overflow: 'revert !important',\n    '& .infinite-scroll-component': {\n      overflow: 'revert !important',\n    },\n  },\n  loading: {\n    width: '100%',\n    textAlign: 'center',\n    paddingTop: '8px',\n    fontSize: '20px',\n  },\n}));\n\nconst HomeworkSection = (props) => {\n  const classes = useStyles();\n  const history = useHistory();\n  const [selectedFromDate, setFromDate] = useState(null);\n  const [selectedToDate, setToDate] = useState(null);\n  const selectedRole = props.selectedRole;\n  const [hasMore, setHasMore] = useState(true);\n  const [currentPage, setCurrentPage] = useState(1);\n\n  const [homeworks, setHomeworks] = useState([]);\n\n  useEffect(() => {\n    let isHomeworkLoading = true;\n    const fetchData = async () => {\n      try {\n        const token = localStorage.getItem('srmToken');\n        const selectedRole = props.selectedRole;\n        const response = await HomeworkService.fetchHomework(\n          { selectedRole, currentPage },\n          token\n        );\n        if (response.status === 200) {\n          if (\n            response.data.data.current_page === response.data.data.last_page\n          ) {\n            if (isHomeworkLoading) {\n              setHomeworks([...homeworks, ...response.data.data.data]);\n              setHasMore(false);\n            }\n          } else {\n            if (isHomeworkLoading) {\n              setHomeworks([...homeworks, ...response.data.data.data]);\n              setCurrentPage(currentPage + 1);\n            }\n          }\n        }\n      } catch (e) {\n        console.log(e);\n      }\n    };\n    fetchData();\n\n    return () => {\n      isHomeworkLoading = false;\n    };\n  }, []);\n\n  const fetchHomeworkOnScroll = async () => {\n    try {\n      const token = localStorage.getItem('srmToken');\n      const selectedRole = props.selectedRole;\n      const response = await HomeworkService.fetchHomework(\n        { selectedRole, currentPage },\n        token\n      );\n\n      if (response.status === 200) {\n        // console.log(response);\n        if (response.data.data.current_page !== response.data.data.last_page) {\n          setHomeworks([...homeworks, ...response.data.data.data]);\n          setCurrentPage(currentPage + 1);\n        } else {\n          setHomeworks([...homeworks, ...response.data.data.data]);\n          setHasMore(false);\n        }\n      }\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  const handleFromDateChange = (date) => {\n    setFromDate(date);\n  };\n  const handleToDateChange = (date) => {\n    setToDate(date);\n  };\n\n  const handleCreateHomework = async () => {\n    try {\n      const token = localStorage.getItem('srmToken');\n      const response = await HomeworkService.createHomework(token);\n      // console.log(response);\n      history.push(`/create-homework/${response.data.homework_id}`);\n    } catch (e) {\n      console.log(e);\n    }\n  };\n\n  let content = homeworks.map((homework, index) => {\n    return <HomeworkCard key={homework.id} homework={homework} />;\n  });\n\n  return (\n    <div className={classes.sectionContainer}>\n      <div className={classes.header}>\n        <div className={classes.filterForm}>\n          {selectedRole === 'teacher' || selectedRole === 'admin' ? (\n            <div className={classes.addNew} onClick={handleCreateHomework}>\n              <img src={AddIcon} alt='add' />\n              <Typography className='new'>New</Typography>\n            </div>\n          ) : (\n            ''\n          )}\n        </div>\n      </div>\n      <br />\n      <Box className={classes.cardBoxPadding}>\n        <InfiniteScroll\n          className={classes.InfiniteScroll}\n          dataLength={homeworks.length}\n          next={fetchHomeworkOnScroll}\n          hasMore={hasMore}\n          loader={\n            <>\n              <div className={classes.loading}>\n                {/* <Typography>Loading...</Typography> */}\n                <CircularProgress color='primary' size={30} />\n              </div>\n              <br />\n            </>\n          }\n          scrollableTarget='scrollable'\n          scrollThreshold={0.2}\n        >\n          {content}\n        </InfiniteScroll>\n        <br />\n        <br />\n        <br />\n      </Box>\n    </div>\n  );\n};\n\nconst mapStateToProps = (state) => {\n  return {\n    selectedRole: state.auth.selectedRole,\n  };\n};\n\nexport default connect(mapStateToProps)(HomeworkSection);\n"]},"metadata":{},"sourceType":"module"}